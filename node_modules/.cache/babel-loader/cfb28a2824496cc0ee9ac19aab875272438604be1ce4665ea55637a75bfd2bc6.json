{"ast":null,"code":"import _slicedToArray from\"/Users/dmitriklimkin/dev/mesto-react/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import Spinner from'./Spinner';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function FormWithValidation(props){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isFormValid=_useState2[0],setIsFormValid=_useState2[1];var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),inputsValidity=_useState4[0],setInputsValidity=_useState4[1];function handleChange(event){var inputs=Array.from(event.currentTarget.elements);var currentInputsValidity=inputs.reduce(function(validity,input){validity[input.name]=input.validity.valid;return validity;},{});setInputsValidity(currentInputsValidity);}function validateForm(){var inputValues=Object.values(inputsValidity);if(inputValues.length===0){setIsFormValid(false);return;}setIsFormValid(inputValues.every(function(i){return i===true;}));}function handleSubmit(event){event.preventDefault();if(event.target.checkValidity()){props.onSubmit();}setIsFormValid(false);}useEffect(function(){validateForm();// eslint-disable-next-line\n},[inputsValidity]);useEffect(function(){setInputsValidity({});},[props.isOpen]);return/*#__PURE__*/_jsxs(\"form\",{className:\"form\",name:props.name,onChange:handleChange,onSubmit:handleSubmit,noValidate:true,children:[props.children,props.isLoading?/*#__PURE__*/_jsx(Spinner,{}):/*#__PURE__*/_jsx(\"button\",{className:\"form__submit \".concat(!isFormValid&&'form__submit_disabled'),type:\"submit\",name:\"submit\",disabled:!isFormValid,children:props.submitText||'Сохранить'})]});}export default FormWithValidation;","map":{"version":3,"names":["useState","useEffect","Spinner","jsx","_jsx","jsxs","_jsxs","FormWithValidation","props","_useState","_useState2","_slicedToArray","isFormValid","setIsFormValid","_useState3","_useState4","inputsValidity","setInputsValidity","handleChange","event","inputs","Array","from","currentTarget","elements","currentInputsValidity","reduce","validity","input","name","valid","validateForm","inputValues","Object","values","length","every","i","handleSubmit","preventDefault","target","checkValidity","onSubmit","isOpen","className","onChange","noValidate","children","isLoading","concat","type","disabled","submitText"],"sources":["/Users/dmitriklimkin/dev/mesto-react/src/components/FormWithValidation.jsx"],"sourcesContent":["import {useState, useEffect} from 'react';\n\nimport Spinner from './Spinner';\n\n\nfunction FormWithValidation(props) {\n  const [isFormValid, setIsFormValid] = useState(false);\n  const [inputsValidity, setInputsValidity] = useState({});\n  \n  function handleChange(event) {\n    const inputs = Array.from(event.currentTarget.elements);\n    \n    const currentInputsValidity = inputs.reduce((validity, input) => {\n      validity[input.name] = input.validity.valid;\n      return validity;\n    }, {});\n    \n    setInputsValidity(currentInputsValidity);\n  }\n  \n  function validateForm() {\n    const inputValues = Object.values(inputsValidity);\n\n    if (inputValues.length === 0) {\n      setIsFormValid(false);\n      return;\n    }\n\n    setIsFormValid(inputValues.every((i) => i === true));\n  }\n  \n  function handleSubmit(event) {\n    event.preventDefault();\n    \n    if (event.target.checkValidity()) {\n      props.onSubmit();\n    }\n    \n    setIsFormValid(false);\n  }\n\n  useEffect(() => {\n    validateForm();\n  \n    // eslint-disable-next-line\n  }, [inputsValidity])\n  \n  useEffect(() => {\n    setInputsValidity({});\n  }, [props.isOpen])\n  \n  return (\n    <form\n      className=\"form\"\n      name={props.name}\n      onChange={handleChange}\n      onSubmit={handleSubmit}\n      noValidate\n    >\n      {props.children}\n      {props.isLoading\n        ? <Spinner />\n        : <button\n          className={`form__submit ${!isFormValid && 'form__submit_disabled'}`}\n          type=\"submit\"\n          name=\"submit\"\n          disabled={!isFormValid}\n        >{props.submitText || 'Сохранить'}</button>}\n    </form>\n  )\n}\n\nexport default FormWithValidation;"],"mappings":"0HAAA,OAAQA,QAAQ,CAAEC,SAAS,KAAO,OAAO,CAEzC,MAAO,CAAAC,OAAO,KAAM,WAAW,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAGhC,QAAS,CAAAC,kBAAkBA,CAACC,KAAK,CAAE,CACjC,IAAAC,SAAA,CAAsCT,QAAQ,CAAC,KAAK,CAAC,CAAAU,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA9CG,WAAW,CAAAF,UAAA,IAAEG,cAAc,CAAAH,UAAA,IAClC,IAAAI,UAAA,CAA4Cd,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAAe,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAAjDE,cAAc,CAAAD,UAAA,IAAEE,iBAAiB,CAAAF,UAAA,IAExC,QAAS,CAAAG,YAAYA,CAACC,KAAK,CAAE,CAC3B,GAAM,CAAAC,MAAM,CAAGC,KAAK,CAACC,IAAI,CAACH,KAAK,CAACI,aAAa,CAACC,QAAQ,CAAC,CAEvD,GAAM,CAAAC,qBAAqB,CAAGL,MAAM,CAACM,MAAM,CAAC,SAACC,QAAQ,CAAEC,KAAK,CAAK,CAC/DD,QAAQ,CAACC,KAAK,CAACC,IAAI,CAAC,CAAGD,KAAK,CAACD,QAAQ,CAACG,KAAK,CAC3C,MAAO,CAAAH,QAAQ,CACjB,CAAC,CAAE,CAAC,CAAC,CAAC,CAENV,iBAAiB,CAACQ,qBAAqB,CAAC,CAC1C,CAEA,QAAS,CAAAM,YAAYA,CAAA,CAAG,CACtB,GAAM,CAAAC,WAAW,CAAGC,MAAM,CAACC,MAAM,CAAClB,cAAc,CAAC,CAEjD,GAAIgB,WAAW,CAACG,MAAM,GAAK,CAAC,CAAE,CAC5BtB,cAAc,CAAC,KAAK,CAAC,CACrB,OACF,CAEAA,cAAc,CAACmB,WAAW,CAACI,KAAK,CAAC,SAACC,CAAC,QAAK,CAAAA,CAAC,GAAK,IAAI,GAAC,CAAC,CACtD,CAEA,QAAS,CAAAC,YAAYA,CAACnB,KAAK,CAAE,CAC3BA,KAAK,CAACoB,cAAc,CAAC,CAAC,CAEtB,GAAIpB,KAAK,CAACqB,MAAM,CAACC,aAAa,CAAC,CAAC,CAAE,CAChCjC,KAAK,CAACkC,QAAQ,CAAC,CAAC,CAClB,CAEA7B,cAAc,CAAC,KAAK,CAAC,CACvB,CAEAZ,SAAS,CAAC,UAAM,CACd8B,YAAY,CAAC,CAAC,CAEd;AACF,CAAC,CAAE,CAACf,cAAc,CAAC,CAAC,CAEpBf,SAAS,CAAC,UAAM,CACdgB,iBAAiB,CAAC,CAAC,CAAC,CAAC,CACvB,CAAC,CAAE,CAACT,KAAK,CAACmC,MAAM,CAAC,CAAC,CAElB,mBACErC,KAAA,SACEsC,SAAS,CAAC,MAAM,CAChBf,IAAI,CAAErB,KAAK,CAACqB,IAAK,CACjBgB,QAAQ,CAAE3B,YAAa,CACvBwB,QAAQ,CAAEJ,YAAa,CACvBQ,UAAU,MAAAC,QAAA,EAETvC,KAAK,CAACuC,QAAQ,CACdvC,KAAK,CAACwC,SAAS,cACZ5C,IAAA,CAACF,OAAO,GAAE,CAAC,cACXE,IAAA,WACAwC,SAAS,iBAAAK,MAAA,CAAkB,CAACrC,WAAW,EAAI,uBAAuB,CAAG,CACrEsC,IAAI,CAAC,QAAQ,CACbrB,IAAI,CAAC,QAAQ,CACbsB,QAAQ,CAAE,CAACvC,WAAY,CAAAmC,QAAA,CACvBvC,KAAK,CAAC4C,UAAU,EAAI,WAAW,CAAS,CAAC,EACzC,CAAC,CAEX,CAEA,cAAe,CAAA7C,kBAAkB"},"metadata":{},"sourceType":"module","externalDependencies":[]}